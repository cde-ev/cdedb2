{% set sidenav_active='core_genesis_list' %}
{% extends "web/core/base.tmpl" %}
{% import "web/util.tmpl" as util with context %}
{% block scripts %}{{ util.cdedb_script('cdedb_helper.js') }}{% endblock %}
{% set jshint='weak' %}
{% block title %}
    {% trans %}View Account Request{% endtrans %}
{% endblock %}
{% block breadcrumb %}
{{ super() }}
{{ util.breadcrumb_link(cdedblink("core/genesis_list_cases"), gettext("Account Requests")) }}
{{ util.breadcrumb_link(cdedblink("core/genesis_show_case"),
                        gettext("View Account Request from %(given_names)s %(family_name)s")|format(
                            given_names=case["given_names"], family_name=case["family_name"]),
                        active="True", icon="user") }}
{% endblock %}
{% block content %}
    <div class="float-along">
        <h4 class="heading-underline">{% trans -%}Case Meta-Information{%- endtrans %}</h4>
        <dl class="dl-horizontal">
            <dt>{% trans %}Status{% endtrans %}</dt>
            <dd>
                {{ gettext(enums['GenesisStati'](case['case_status'])|string) }}
            </dd>
            <dt>{% trans %}Realm{% endtrans %}</dt>
            <dd>
                {% if case['realm'] == 'ml' %}
                    {{ util.make_icon("envelope", title=gettext("Mailinglists")) }} {{ gettext("Mailinglists") }}
                {% elif case['realm'] == 'event' %}
                    {{ util.make_icon("blackboard", title=gettext("Events")) }} {{ gettext("Events") }}
                {% else %}
                    Impossible!
                {% endif %}
            </dd>
            <dt>{% trans %}Creation Time{% endtrans %}</dt>
            <dd>
                {{ case['ctime']|datetime(formatstr="%d.%m.%Y %H:%M:%S") }}
            </dd>
            <dt>{% trans %}Rationale{% endtrans %}</dt>
            <dd>
                {{ case['notes'] }}
            </dd>
            <dt>{% trans %}Reviewer{% endtrans %}</dt>
            <dd>
                {% if reviewer %}
                    {{ util.persona_anchor(reviewer) }}
                {% else %}
                    —
                {% endif %}
            </dd>
        </dl>
        <h4 class="heading-underline">{% trans -%}Persona Information{%- endtrans %}</h4>
        <dl class="dl-horizontal">
            <dt>{% trans -%}Name{%- endtrans %}</dt>
            <dd>
                {{ case['given_names'] }} {{ case['family_name'] }}
            </dd>
            {% if case['birthday'] %}
                <dt>{% trans -%}Birthday{%- endtrans %}</dt>
                <dd>{{ case['birthday']|date(lang=lang) }}</dd>
            {% endif %}
            {% if case['gender'] %}
                <dt>{% trans -%}Gender{%- endtrans %}</dt>
                <dd>{{ gettext(enums['Genders'](case['gender'])|string) }}</dd>
            {% endif %}
            <dt>{% trans -%}E-Mail{%- endtrans %}</dt>
            <dd>
                {% if case['username'] %}
                    {{ util.username_mailto(case) }}
                {% else %}
                    —
                {% endif %}
            </dd>
            {% if case['telephone'] %}
                <dt>{% trans -%}Phone{%- endtrans %}</dt>
                <dd>{{ util.tel_link(case['telephone']) }}</dd>
            {% endif %}
            {% if case['mobile'] %}
                <dt>{% trans -%}Mobile Phone{%- endtrans %}</dt>
                <dd>{{ util.tel_link(case['mobile']) }}</dd>
            {% endif %}
            {% if (case['address'] or case['address_supplement'] or case['postal_code']
                        or case['location'] or case['country']) %}
                <dt>{% trans -%}Address{%- endtrans %}</dt>
                <dd>
                    {{ case['address'] }}{% if case['address'] %}<br />{% endif %}
                    {{ case['address_supplement'] }}{% if case['address_supplement'] %}<br />{% endif %}
                    {{ case['postal_code'] }} {{ case['location'] }}{% if case['location'] %}<br />{% endif %}
                    {{ case['country'] }}
                </dd>
            {% endif %}
        </dl>
    </div>
    <div class="col-sm-12 button-par">
        <form action="{{ cdedblink('core/genesis_decide') }}" method="POST"
         id="genesiseventapprovalform" style="display: inline;">
            {{ util.anti_csrf_token('core/genesis_decide') }}
            {{ util.input_hidden(name="case_id", value=case_id) }}
            {{ util.input_hidden(name="case_status", value=enums['GenesisStati'].approved.value) }}
            {{ util.input_submit(value=gettext("Approve"), aclass="btn btn-sm btn-success") }}
        </form>
        <form action="{{ cdedblink('core/genesis_decide') }}" method="POST"
         id="genesiseventrejectionform" class="rejection-form" style="display: inline;">
            {{ util.anti_csrf_token('core/genesis_decide') }}
            {{ util.input_hidden(name="case_id", value=case_id) }}
            {{ util.input_hidden(name="case_status", value=enums['GenesisStati'].rejected.value) }}
            {{ util.input_submit(icon="remove", value=gettext("Reject"),
                aclass="btn btn-sm btn-danger") }}
        </form>
        {{ util.href(cdedblink('core/genesis_modify_form'), gettext("Edit"),
            aclass="btn btn-warning btn-sm", icon="pencil") }}
        {{ util.href(cdedblink("core/genesis_list_cases"), gettext("Back")) }}
</div>
{% endblock %}
