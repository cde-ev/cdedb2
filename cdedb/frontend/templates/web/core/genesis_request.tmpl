{% extends "web/core/base.tmpl" %}
{% import "web/util.tmpl" as util with context %}
{% block title %}Account anfordern{% endblock %}
{% block content %}
    <p>
        Mit dem folgenden Formular kannst Du einen Account für die CdE-Datenbank beantragen. Gib dazu
        bitte kurz an, zu welchem Zweck Du den Account benötigst (bspw. für welche Veranstaltung Du Dich anmelden
        möchtest).
    </p>
    <p>
        Nachdem Du das Formular abgeschickt hast, wird eine E-Mail an die
        angegebene Adresse verschickt, die einen Verifikations-Link
        enthält. Diesen musst Du öffnen, um deine Anfrage zu bestätigen.
        Erst danach wird die Anfrage von einem Admin überprüft und
        gegebenenfalls ein Account erstellt, worüber Du dann per E-Mail
        benachrichtigt wirst.
    </p>

    <form action="{{ cdedblink('core/genesis_request')|e }}" method="POST" id="genesisform" class="form-horizontal">
        <div>
            {{ util.form_input_text(name="given_names", label="Vorname(n)", small=True) }}
            {{ util.form_input_text(name="family_name", label="Nachname", small=True) }}
            {{ util.form_input_text(name="username", label="E-Mail-Adresse", small=True, type="email") }}
            {{ util.form_input_select(name="realm", small=True, entries=(
                ("event", "CdE-Veranstaltung"),
                ("ml", "CdE-Mailingliste")),
                label="Grund", anid="realm-select") }}
            {{ util.form_input_textarea(name="notes", label="Begründung (max. {} Zeichen)".format(max_rationale),
                                        small=True, maxlength=max_rationale) }}
            <div id="event-field-container">
                <p class="text-muted">{{ util.make_icon('info-sign') }}
                    Die folgenden Felder sind nur relevant, falls Du einen Account für eine Veranstaltung beantragst.</p>
                {{ util.form_input_select(name="gender", entries=default_selections['gender'], label="Geschlecht", small=True) }}
                {{ util.form_input_text(name="birthday", label="Geburtstag", placeholder="YYYY-MM-DD", type="date", small=True) }}
                {{ util.form_input_text(name="telephone", label="Telefon", small=True) }}
                {{ util.form_input_text(name="mobile", label="Mobiltelefon", small=True) }}
                {{ util.form_input_text(name="address", label="Straße", small=True) }}
                {{ util.form_input_text(name="address_supplement", label="Addresszusatz", small=True) }}
                {{ util.form_input_text(name="postal_code", label="Postleitzahl", small=True) }}
                {{ util.form_input_text(name="location", label="Stadt", small=True) }}
                {{ util.form_input_text(name="country", label="Land", small=True) }}
            </div>
            <script type="text/javascript">
                var $select = $('#realm-select');
                var show_event_fields = function() {
                    if ($select.val() === 'event') {
                        $('#event-field-container').show();
                    } else {
                        $('#event-field-container').hide();
                    }
                };
                $select.change(show_event_fields);
                show_event_fields();
            </script>

            {{ util.form_input_submit(value="Antrag abschicken", small=True) }}
        </div>
    </form>
{% endblock %}
