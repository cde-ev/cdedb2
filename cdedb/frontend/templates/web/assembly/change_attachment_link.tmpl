{% set sidenav_active='assembly_ballots' if ambience['ballot'] else 'assembly_show' %}
{% extends "web/assembly/base.tmpl" %}
{% import "web/util.tmpl" as util with context %}
{% import "web/assembly/util.tmpl" as assembly_util with context %}
{% block title %}
    {% if ambience['ballot'] %}
        {% trans title=ambience['assembly']['title'] + "/" + ambience['ballot']['title'] %}
            Change Attachment Link ({{ title }})
        {% endtrans %}
    {% else %}
        {% trans title=ambience['assembly']['title'] %}
            Change Attachment Link ({{ title }})
        {% endtrans %}
    {% endif %}
    â€“ {{ assembly_util.small_attachment_title(attachment, history, icon=False) }}
{% endblock %}
{% block heading %}
    <h1 class="title">
        {% trans %}
            Change Attachment Link
        {% endtrans %}
        {% if ambience['ballot'] %}
            <small>
                {{- util.make_icon('thumbs-up', arialabel=gettext("Ballot")) }} {{ ambience['ballot']['title'] -}}
            </small>
        {% else %}
            <small>
                {{- util.make_icon('bullhorn', arialabel=gettext("Assembly")) }} {{ ambience['assembly']['title'] -}}
            </small>
        {% endif %}
        <small>
            {{ assembly_util.small_attachment_title(attachment, history) }}
        </small>
    </h1>
{% endblock %}
{% block breadcrumb %}
    {{ super() }}
    {{ util.breadcrumb_link(cdedblink("assembly/show_assembly"), ambience['assembly']['title'], icon="bullhorn") }}
    {% if ambience['ballot'] %}
        {{ util.breadcrumb_link(cdedblink("assembly/list_ballots"), gettext("Ballots")) }}
        {{ util.breadcrumb_link(cdedblink("assembly/show_ballot"), ambience['ballot']['title'], icon="thumbs-up") }}
    {% endif %}
    {{ util.breadcrumb_link(cdedblink("assembly/show_attachment"),
                            assembly_util.small_attachment_title(attachment, history, icon=False), icon="file") }}
    {{ util.breadcrumb_link(cdedblink("assembly/change_attachment_link"), gettext("Change Attachment Link"), active=True) }}
{% endblock %}
{% block content %}
    <div class="p text-info">
        {{ util.make_icon("info") }}
        {% trans %}
            Here you can change the association of this attachment.
            You can link it to a (different) ballot or directly to the assembly as a general file.
        {% endtrans %}
    </div>
    <form action="{{ cdedblink('assembly/change_attachment_link') }}" method="POST" enctype="multipart/form-data"
            id="changeattachmentlinkform" class="form-horizontal">
        {{ util.anti_csrf_token('assembly/change_attachment_link') }}
        {{ util.input_hidden(name="attachment_id") }}
        {{ util.form_input_select("new_ballot_id", label=gettext("Ballot"), entries=ballot_entries, nulloption="&nbsp;"|s) }}
        {{ util.form_input_submit(cancellink=(
            cdedblink('assembly/show_attachment') if attachment else (
                cdedblink('assembly/show_ballot') if ambience['ballot']
                    else cdedblink('assembly/show_assembly')))) }}
    </form>
{% endblock %}
