{% set sidenav_active='assembly_ballots' %}
{% extends "web/assembly/base.tmpl" %}
{% import "web/util.tmpl" as util with context %}
{% block scripts %}{{ util.cdedb_script('helper') }}{% endblock %}
{% set jshint='weak' %}
{% block title %}{{ gettext("Edit %(ballot)s %(assembly)s")|
                    format(ballot=ambience['ballot']['title'],
                           assembly=ambience['assembly']['title']) }}{% endblock %}
{% block breadcrumb %}
    {{ super() }}
    {{ util.breadcrumb_link(cdedblink("assembly/show_assembly"), ambience['assembly']['title'], icon="bullhorn") }}
    {{ util.breadcrumb_link(cdedblink("assembly/list_ballots"), gettext("Ballots")) }}
    {{ util.breadcrumb_link(cdedblink("assembly/show_ballot"), ambience['ballot']['title'], icon="thumbs-up") }}
    {{ util.breadcrumb_link(cdedblink("assembly/change_ballot"), gettext("Edit"), active=True) }}
{% endblock %}
{% block heading %}
    <h1 class="title">
        {{ gettext("Edit Ballot") }}
        <small>{{ util.make_icon('thumbs-up') }} {{ ambience['ballot']['title']|e }}</small>
    </h1>
{% endblock %}
{% block content %}
    <form action="{{ cdedblink('assembly/change_ballot')|e }}" method="POST" id="changeballotform"
            class="form-horizontal">
        {{ util.form_input_text(name="title", label=gettext("Title")) }}
        {{ util.form_input_textarea(name="description", label=gettext("Description"), rows="5",
                                    info=gettext("Supports reStructuredText")) }}
        {{ util.form_input_text(name="vote_begin", label=gettext("Start of voting period"), type="datetime-local",
                                placeholder="YYYY-MM-DDThh:ii:ss") }}
        {{ util.form_input_text(name="vote_end", label=gettext("End of voting period"), type="datetime-local",
                                placeholder="YYYY-MM-DDThh:ii:ss") }}
        {{ util.form_input_text(name="quorum", label=gettext("Quorum")) }}
        {{ util.form_input_text(name="vote_extension_end", label=gettext("End of extension"), type="datetime-local",
                                placeholder="YYYY-MM-DDThh:ii:ss") }}
        {{ util.form_input_text(name="votes", label=gettext("Number of votes"),
                               info=gettext("Leave empty for Preferential Vote.")) }}
        {{ util.form_input_checkbox(name="use_bar", label=gettext("Allow rejection")) }}
        {{ util.form_input_textarea(name="notes", label=gettext("Admin-Notes"), rows="5",
                                    info=gettext("Supports reStructuredText")) }}
        <div class="form-group">
            <div class="col-sm-offset-4 col-sm-8">
                <div class="form-control-static text-info">
                    {{ util.make_icon('info-sign') }} {{ gettext("Warning: All changes will be immediately "
                    "visible to all CdE-Members and Assembly-Participants.") }}
                </div>
            </div>
        </div>
        {{ util.form_input_submit(value=gettext("Save"), cancellink=cdedblink('assembly/show_ballot')) }}
    </form>
    <script type="text/javascript">
        $('#changeballotform').cdedbProtectChanges();
    </script>
{% endblock %}
