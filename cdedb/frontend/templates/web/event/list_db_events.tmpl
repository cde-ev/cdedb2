{% set sidenav_active='event_list' %}
{% extends "web/event/base.tmpl" %}
{% import "web/util.tmpl" as util with context %}
{% block title %}
    {% trans -%}
    	Manage Events
    {%- endtrans %}
{% endblock %}
{% block breadcrumb %}
{{ super() }}
{{ util.breadcrumb_link(cdedblink("event/list_db_events"), gettext("Manage Events"), active="True") }}
{% endblock %}

{% macro format_entry(event) %}
    <div class="row list-group-item{% if event['is_archived'] %} list-group-item-muted{% endif %}">
        <div class="col-sm-4">
            {{ util.href(cdedblink("event/show_event", {'event_id': event['id']}), event['title']) }}
        </div>
        <div class="col-sm-5 small">
            {{ event['begin']|date(lang=lang)|e }}&#8239;â€“&#8239;{{ event['end']|date(lang=lang)|e }}
            {% if event['parts']|length > 1 %}
                ({% trans count=event['parts']|length|e -%}
                    {{ count }} Parts
                {%- endtrans %})
            {% endif %}
        </div>
        <div class="col-sm-3 small">
            <a href="{{ cdedblink('event/registration_query', {'event_id': event['id']})|e }}">
                {% trans count=event['registrations']|e -%}
                	{{ count }} Registrations
                {%- endtrans %}
            </a>,
            {% trans count=event['orgas']|length|e, number=event['orgas']|length -%}
                {{ count }} Orga
            {%- pluralize number -%}
                {{ count }} Orgas
            {%- endtrans %}
        </div>
    </div>
{% endmacro %}
{% block content %}
    <div class="p">
        {{ util.href(cdedblink("event/create_event_form"), gettext("Create Event"), aclass="btn btn-success btn-sm",
                icon="plus") }}
    </div>
    
    <h3>{% trans -%}Current Events{%- endtrans %}</h3>
    <div class="list-group list-group-hover list-group-condensed">
        {% for event_id, entry in events|dictsort|reverse %}
            {% if not entry['is_archived'] %}
                {{ format_entry(entry) }}
            {% endif %}
        {% endfor %}
    </div>

    <h3>{% trans -%}Archived Events{%- endtrans %}</h3>
    <div class="list-group list-group-hover list-group-condensed">
        {% for event_id, entry in events|dictsort|reverse %}
            {% if entry['is_archived'] %}
                {{ format_entry(entry) }}
            {% endif %}
        {% endfor %}
    </div>
{% endblock %}
