{% extends "web/de/base.tmpl" %}
{% import "web/de/util.tmpl" as util with context %}

{% macro ml_inner_navigation(data) %}
    <li>
        <a href="{{ cdedblink("ml/show_mailinglist", {'mailinglist_id': data['id']})|e }}"> {{ data['title']|e }} </a>
        <ul>
            {% if data['id'] in user.moderator or is_admin %}
                <li><a href="{{ cdedblink("ml/view_ml_log", {'mailinglist_id': data['id']})|e }}">Log</a></li>
                <li><a href="{{ cdedblink("ml/management", {'mailinglist_id': data['id']})|e }}">Verwalten</a></li>
                <li><a href="{{ cdedblink("ml/check_states", {'mailinglist_id': data['id']})|e }}">Statuscheck</a></li>
            {% endif %}
            {% if is_admin %}
                <li>
                    <a href="{{ cdedblink("ml/change_mailinglist_form", {'mailinglist_id': data['id']})|e }}">
                        Konfiguration
                    </a>
                </li>
            {% endif %}
        </ul>
    </li>
{% endmacro %}

{% block navigation %}
    <ul>
        <li>
            <a href="{{ cdedblink("core/index")|e }}">Start</a>
            <ul>
                <li><a href="{{ cdedblink("core/mydata")|e }}">Meine Daten</a></li>
                <li><a href="{{ cdedblink("core/change_password_form")|e }}">Passwort ändern</a></li>
            </ul>
        </li>
        {% if "formermember" in user.roles %}
            <li><a href="{{ cdedblink("cde/index")|e }}">CdE</a></li>
        {% endif %}
        {% if "event_user" in user.roles %}
            <li><a href="{{ cdedblink("event/index")|e }}">Veranstaltungen</a></li>
        {% endif %}
        {% if "ml_user" in user.roles %}
            <li>
                <a href="{{ cdedblink("ml/index")|e }}">Mailinglisten</a>
                <ul>
                    <li><a href="{{ cdedblink("ml/list_mailinglists")|e }}">Mailinglisten-Übersicht</a></li>
                    {% if is_admin %}
                        <li><a href="{{ cdedblink("ml/create_user_form")|e }}">Neuen Nutzer anlegen</a></li>
                        <li><a href="{{ cdedblink("ml/user_search_form")|e }}">Nutzersuche</a></li>
                        <li><a href="{{ cdedblink("ml/view_log")|e }}">Log</a></li>
                        <li><a href="{{ cdedblink("ml/list_all_mailinglists")|e }}">alle Mailinglisten</a></li>
                        <li><a href="{{ cdedblink("ml/create_mailinglist_form")|e }}">Mailingliste anlegen</a></li>
                    {% endif %}
                    {% block inner_navigation %}
                        <!-- for mailinglist specific actions -->
                    {% endblock %}
                </ul>
            </li>
        {% endif %}
        {% if "assembly_user" in user.roles %}
            <li>Versammlung</li>
        {% endif %}
    </ul>
{% endblock %}
