{% if ambience['persona']['id'] == user.persona_id %}{% set sidenav_active='core_mydata'%}{% endif %}
{% extends "web/de/core/base.tmpl" %}
{% import "web/de/util.tmpl" as util with context %}
{% block scripts %}{{ util.cdedb_script('helper') }}{% endblock %}
{% block title %}
    Profilbild von {{ ambience['persona']['given_names']|e }} {{ ambience['persona']['family_name']|e }}
{% endblock %}
{% block breadcrumb %}
{{ util.breadcrumb_link(cdedblink("core/index"), "Start") }}
{{ util.breadcrumb_link(show_user_link(ambience['persona']['id']), "{} {}".format(ambience['persona']['given_names'],
                                                                                  ambience['persona']['family_name']),
        icon="user") }}
{{ util.breadcrumb_link(cdedblink('core/set_foto_form'), "Profilbild ändern", active="True") }}
{% endblock %}
{% block content %}

    <div class="row">
        {% if foto %}
            <div class="col-md-5">
                <h3>Aktuelles Bild</h3>
                <img src="{{ cdedblink('core/get_foto', {'foto': foto})|e }}" class="profilepic img-thumbnail">

                <script type="text/javascript">
                    $(function() {
                        $('#resetfotoform').cdedbProtectAction();
                    });
                </script>
                <form action="{{ cdedblink('core/set_foto')|e }}" method="POST" id="resetfotoform">
                    <div class="form-group">
                        {{ util.input_submit(value="Foto löschen", aclass="btn btn-danger", icon="trash") }}
                    </div>
                </form>
            </div>
        {% endif %}

        <div class="col-md-7">
            <h3>Neues Bild hochladen</h3>
            <p>
                Das Bild muss folgende Anforderungen erfüllen:
            </p>
            <ul>
                <li>JPEG- oder PNG-Datei</li>
                <li>max. 128 kiB Dateigröße</li>
                <li>möglichst quadratisch</li>
            </ul>
            <form action="{{ cdedblink('core/set_foto')|e }}" method="POST" enctype="multipart/form-data"
                    id="setfotoform">
                <div class="form-group">
                    <div class="input-group">
                        {{ util.input_file(name="foto", accept="image/*") }}
                        <div class="input-group-btn">
                            {{ util.input_submit(value="Hochladen") }}
                        </div>
                    </div>
                    {{ util.output_errors('foto') }}
                </div>
            </form>
        </div>
    </div>

    {{ util.href(show_user_link(ambience['persona']['id']), "Zurück", icon="arrow-left", aclass="btn btn-default") }}
{% endblock %}
