{% extends "web/de/event/base.tmpl" %}
{% import "web/de/util.tmpl" as util with context %}
{% block title %}{{ data['given_names']|e }} {{ data['family_name']|e }}{% endblock %}
{% block content %}
    {% if data['id'] == user.persona_id or is_admin %}
        <p>
            {% if is_admin %}
                <a href="{{ cdedblink('event/admin_change_user_form')|e }}">Bearbeiten</a>
            {% else %}
                <a href="{{ cdedblink('event/change_user_form')|e }}">Bearbeiten</a>
            {% endif %}
        </p>
    {% endif %}
    <table>
        <tr> <th colspan="2">Person</th> </tr>
        <tr>
            <td>Name</td>
            <td>{{ data['title']|e }} {{ data['given_names']|e }} {{ data['family_name']|e }} {{ data['name_supplement']|e }}</td>
        </tr>
        <tr>
            <td>Rufname</td>
            <td>{{ data['display_name']|e }}</td>
        </tr>
        <tr>
            <td>Geburtstag</td>
            <td>{{ data['birthday']|e }}</td>
        </tr>
        <tr>
            <td>Geschlecht</td>
            <td>{{ data['gender']|gender|e }}</td>
        </tr>
        <tr>
            <td>CdEDB-ID</td>
            <td>{{ data['id']|cdedbid|e }}</td>
        </tr>
        <tr> <th colspan="2">Kontakt</th> </tr>
        <tr>
            <td>Email</td>
            <td>
                {{ data['username']|e }}
                {% if is_admin and data['id'] != user.persona_id %}
                    <a href="{{ cdedblink('core/admin_username_change_form')|e }}">Email ändern</a>
                {% else %}
                    <a href="{{ cdedblink('core/change_username_form')|e }}">Email ändern</a>
                {% endif %}
            </td>
        </tr>
        <tr>
            <td>Telefon</td>
            <td>{{ data['telephone']|e }}</td>
        </tr>
        <tr>
            <td>Mobiltelefon</td>
            <td>{{ data['mobile']|e }}</td>
        </tr>
        <tr> <th colspan="2">Adresse</th> </tr>
        <tr>
            <td>Straße</td>
            <td>{{ data['address']|e }}</td>
        </tr>
        <tr>
            <td>Adresszusatz</td>
            <td>{{ data['address_supplement']|e }}</td>
        </tr>
        <tr>
            <td>Stadt</td>
            <td>{{ data['postal_code']|e }} {{ data['location']|e }}</td>
        </tr>
        <tr>
            <td>Land</td>
            <td>{{ data['country']|e }}</td>
        </tr>
        <tr>
            <td>CdE-Wolken-Zugriff</td>
            <td>
                {% if data['cloud_account'] %}
                    {{ util.checkbox_checked() }}
                {% else %}
                    {{ util.checkbox_unchecked() }}
                {% endif %}
            </td>
        </tr>
        {% if is_admin %}
            <tr>
                <td>Account aktiv</td>
                <td>
                    {% if data['is_active'] %}
                        {{ util.checkbox_checked(anid='activity_checkbox') }}
                        <form action="{{ cdedblink('core/toggle_activity', {'activity' : False})|e }}" method="POST" id="activitytoggleform">
                            <div>{{ util.input_submit(value="Account deaktivieren") }}</div>
                        </form>
                    {% else %}
                        {{ util.checkbox_unchecked(anid='activity_checkbox') }}
                        <form action="{{ cdedblink('core/toggle_activity', {'activity' : True})|e }}" method="POST" id="activitytoggleform">
                            <div>{{ util.input_submit(value="Account aktivieren") }}</div>
                        </form>
                    {% endif %}
                </td>
            </tr>
            <tr>
                <td>Privilegien-Bits</td>
                <td>{{ data['db_privileges_ascii']|e }}</td>
            </tr>
            <tr>
                <td>Notizen</td>
                <td>{{ data['notes']|e|linebreaks }}</td>
            </tr>
        {% endif %}
    </table>

    {% if data['id'] == user.persona_id or is_admin %}
        <p>
            {% if is_admin %}
                <a href="{{ cdedblink('event/admin_change_user_form')|e }}">Bearbeiten</a>
            {% else %}
                <a href="{{ cdedblink('event/change_user_form')|e }}">Bearbeiten</a>
            {% endif %}
        </p>
    {% endif %}
    {% if is_admin %}
        <form action="{{ cdedblink('core/admin_password_reset')|e }}" method="POST" id="adminpasswordresetform">
            <div>{{ util.input_submit(value="Passwort zurücksetzen") }}</div>
        </form>
    {% endif %}
{% endblock %}
