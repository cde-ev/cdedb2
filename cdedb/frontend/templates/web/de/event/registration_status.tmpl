{% set sidenav_active='event_register' %}
{% extends "web/de/event/base.tmpl" %}
{% import "web/de/util.tmpl" as util with context %}
{% block title %}Deine Anmeldung ({{ ambience['event']['title']|e }}){% endblock %}
{% block breadcrumb %}
{{ util.breadcrumb_link(cdedblink("event/index"), "Veranstaltungen") }}
{{ util.breadcrumb_link(cdedblink("event/show_event"), ambience['event']['title'], icon="blackboard") }}
{{ util.breadcrumb_link(cdedblink("event/registration_status"), "Meine Anmeldung", active=True) }}
{% endblock %}
{% block content %}
    {% if ambience['event']['registration_soft_limit'] >= now().date() %}
        <p>
            Änderungen sind bis zum Anmeldeschluss ({{ ambience['event']['registration_soft_limit']|date|e }}) möglich.
        </p>
    {% endif %}
    {% if not registration['payment'] %}
        <p>
             Beachte bitte, dass deine Anmeldung erst mit Überweisung des
             Teilnehmerbeitrags gültig wird. Überweise dazu bitte {{ fee|e}}€
             auf folgendes Konto. Achte bitte bei internationalen
             Überweisungen darauf, dass der Empfänger keine Gebühren zahlen
             muss.
        </p>
        <p>
            Kontoinhaber: CdE e.V.<br>
            IBAN: {{ ambience['event']['iban']|e }}<br>
            BIC:  BFSWDE33XXX (BIC = SWIFT-Code)<br>
            Bank: Bank für Sozialwirtschaft<br>
            Verwendungszweck: {{ user['given_names']|e }} {{ user['family_name']|e }},
                              {{ user['persona_id']|cdedbid|e }}, {{ ambience['event']['title']|e }}
        </p>
    {% endif %}
    {% if age.is_minor() and not registration['parental_agreement'] %}
        Du musst noch die Einverständniserklärung deiner
        Erziehungsberechtigten an die Orgas schicken. Du findest die Vorlage
        {{ util.href(cdedblink('event/get_minor_form'), "hier") }}.
    {% endif %}
    <table>
        <tr><th colspan="2">Status</th></tr>
        {% for part_id, part in registration['parts']|dictsort %}
            <tr>
                <td>{{ ambience['event']['parts'][part_id]['title']|e }}</td>
                <td>{{ gettext(part['status']|enum(enums['RegistrationPartStati']))|e }}</td>
            </tr>
        {% endfor %}
        <tr><th colspan="2">Sonstige Angaben</th></tr>
        <tr>
            <td>Gemischte Unterbringung</td>
            <td>
                {% if not age.may_mix() %}
                    Keine gemischte Unterbringung.
                {% else %}
                    {% if registration['mixed_lodging'] %}
                        Ich bin mit einer gemischten Unterbringung einverstanden.
                    {% else %}
                        Ich will geschlechter-getrennt untergebracht werden.
                    {% endif %}
                {% endif %}
            </td>
        </tr>
        <tr>
            <td>Fotos</td>
            <td>
                Ich bin
                {% if not registration['foto_consent'] %}
                    <strong>nicht</strong>
                {% endif %}
                damit einverstanden, dass Fotos und Aufnahmen meiner Person,
                die im Rahmen dieser Veranstaltung entstehen, für die
                Veranstaltungsdokumentation und eine CdE-interne,
                passwortgeschützte Fotogalerie verwendet werden. Einzelne
                Fotos können auf gesonderten Wunsch davon ausgenommen
                werden.
            </td>
        </tr>
        <tr>
            <td>Anmerkungen</td>
            <td>
                {{ registration['notes']|rst }}
            </td>
        </tr>
        {% for part_id, part in registration['parts']|dictsort %}
            {% if enums['RegistrationPartStati'](part['status']).is_involved()
                  and registration['choices'].get(part_id) %}
                <tr><th colspan="2">Kurswahl {{ ambience['event']['parts'][part_id]['title']|e }}</th></tr>
                {% for prio in ("Erstwahl", "Zweitwahl", "Drittwahl") %}
                    <tr>
                            <td>{{ prio|e }}</td>
                            <td>{{ courses[registration['choices'][part_id][loop.index0]]['title']|e }}</td>
                    </tr>
                {% endfor %}
                <tr>
                        <td>Kursleiter</td>
                        <td>
                            {% if not part['instructor'] %}
                                Keine Kursleitung.
                            {% else %}
                                {{ courses[part['instructor']]['title']|e }}
                            {% endif %}
                        </td>
                </tr>
            {% endif %}
        {% endfor %}
    </table>
    {% if ambience['event']['registration_soft_limit'] >= now().date() %}
        <p>
            {{ util.href(cdedblink("event/amend_registration_form"), "Ändern") }}
        </p>
    {% endif %}
{% endblock %}
