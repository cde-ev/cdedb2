{% extends "web/de/event/base.tmpl" %}
{% import "web/de/util.tmpl" as util with context %}
{% block scripts %}{{ util.jquery_with_ui_preamble() }}{% endblock %}
{% set jshint='strong' %}
{% block title %}Fragebogen umordnen ({{ ambience['event']['title']|e }}){% endblock %}
{% block content %}
    <ul id="rowlist">
        {% for entry in questionnaire %}
            <li id="{{ loop.index0|e }}">
                {% if entry['field_id'] %}
                    Abfrage: {{ ambience['event']['fields'][entry['field_id']]['field_name']|e }}
                {% else %}
                    Ãœberschrift: {{ entry['title']|e }}<br>
                    Text: {{ entry['info']|e }}
                {% endif %}
            </li>
        {% endfor %}
    </ul>
    <form action="{{ cdedblink('event/reorder_questionnaire')|e }}" method="POST" id="reorderquestionnaireform">
        {{ util.input_hidden(name="order", value="", anid="orderinput") }}
        {{ util.form_input_submit(value="Umordnen", readonly=True, aclass="jsEnabled") }}
    </form>
    <script type="text/javascript">
        $(document).ready(function(){
            $("#rowlist").sortable();
            $("#rowlist").disableSelection();
            $("#reorderquestionnaireform").submit(function(){
                var sorted = $("#rowlist").sortable("toArray")
                $("#orderinput").val(sorted.join(","))
            });
        });
    </script>
{% endblock %}
