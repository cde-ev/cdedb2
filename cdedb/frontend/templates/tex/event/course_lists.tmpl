<<% extends "tex/event/base_article.tmpl" %>>
<<% block documentclass %>>
    \documentclass[12pt,portrait,parskip=half+,a5paper]{scrartcl}
<<% endblock %>>

<<% block extra_preamble %>>

    \parindent 0pt\relax
    \pagestyle{empty}
    \usepackage{calc}
    \newcommand{\debugbox}{}
    \newcommand{\logosize}{0.2}

<<% endblock %>>
<<% block content %>>
    <<% for course_id, course in courses|dictsort('nr') %>>
        <<% for track_id in course['active_segments']|sort %>>
        <<% set key = (course_id, track_id) %>>
            \begin{minipage}[c][\logosize\linewidth][c]{0.8\linewidth}
                \raggedright
                \Huge\textbf{<<< course['shortname']|te >>>}\\
                \normalsize <<< course['title']|te >>>\\
                \emph{<<< ambience['event']['tracks'][track_id]['shortname']|te >>>}\\
                <<< (attendees[key]|length - instructors[key]|length)|te >>> Teilnehmer
                , <<< instructors[key]|length|te >>> Kursleiter
            \end{minipage}
            \begin{minipage}[c][\logosize\textwidth][t]{\logosize\linewidth}
                \includegraphics[keepaspectratio=true, width=\textwidth,height=\textwidth]{./course-logo-<<< course_id|te >>>}
            \end{minipage}
            \begin{itemize}
                <<% for registration_id in attendees[(course_id, track_id)] %>>
                    <<% with p = personas[registrations[registration_id]['persona_id']] %>>
                        \item
                            <<% if registration_id in instructors[(course_id, track_id)] %>>
                                \emph{
                                    <<<- personas[registrations[registration_id]['persona_id']]['given_names']|te >>>
                                    <<< personas[registrations[registration_id]['persona_id']]['family_name']|te ->>>
                                }
                            <<% else %>>
                                <<<- personas[registrations[registration_id]['persona_id']]['given_names']|te >>>
                                <<< personas[registrations[registration_id]['persona_id']]['family_name']|te ->>>
                                <<% if p['age'].is_minor() %>>
                                    \fbox{<<< p['age'].name|upper|te >>>}
                                <<% endif %>>
                            <<% endif %>>
                    <<% endwith %>>
                <<% else %>>
                    \item \emph{niemand}
                <<% endfor %>>
            \end{itemize}
            \vspace{\fill}
            \begin{minipage}[t]{\textwidth}
                <<% if course_room_field -%>>
                    Kursraum: <<< course['fields'].get(course_room_field, "")|te >>>
                <<%- endif %>>
            \end{minipage}
            \clearpage
        <<% endfor %>>
    <<% endfor %>>
<<% endblock %>>
