<<% extends "tex/de/event/base_article.tmpl" %>>
<<% block extra_preamble %>>
    \parindent 0pt\relax
    \newcommand\course[5]{
        \section*{#1 (#2)}
        Kursleiter: #3
        \par
        Notizen: #4
        \par
        Erst-/Zweit-/Drittwahlen: #5}
    \newcommand\participant[6]{
        \section*{#1 (#2)}
        #3
        #4
        #5
        #6}
<<% endblock %>>
<<% block content %>>
    <<% for course_id, cdata in courses|dictsort %>>
        <<% for part_id in cdata['parts']|sort %>>
            \course{<<< cdata['title']|te >>>}{<<< ambience['event']['parts'][part_id]['title']|te >>>}%
                   {<<< cdata['instructors']|te >>>}{<<< cdata['notes']|te >>>}%
                   {<<< counts[course_id][(part_id, 0)] >>>/%
                    <<< counts[course_id][(part_id, 1)] >>>/%
                    <<< counts[course_id][(part_id, 2)] >>>}
        <<% endfor %>>
    <<% endfor %>>
    \clearpage
    <<% for registration_id, rdata in registrations|dictsort %>>
        <<% if rdata['persona_id'] not in ambience['event']['orgas'] %>>
            <<% for part_id, pdata in ambience['event']['parts']|dictsort %>>
                <<% if rdata['parts'][part_id]['status'] == enums['RegistrationPartStati'].participant %>>
                    \participant{<<< personas[rdata['persona_id']]['given_names']|te >>>
                                 <<< personas[rdata['persona_id']]['family_name']|te >>>}%
                                {<<< pdata['title']|te >>>}%
                                {<<% if rdata['parts'][part_id]['course_instructor'] -%>>
                                    Kursleiter:
                                    <<< courses[rdata['parts'][part_id]['course_instructor']]['title']|te >>>
                                    \par
                                <<%- endif %>>}%
                    <<% for label in ("Erstwahl", "Zweitwahl", "Drittwahl") -%>>
                                {<<% if rdata['choices'][part_id]|length > loop.index0 -%>>
                                    <<< label|te >>>:
                                    <<< courses[rdata['choices'][part_id][loop.index0]]['title']|te >>>
                                    \par
                                 <<% endif %>>}%
                    <<% endfor %>>
                <<% endif %>>
            <<% endfor %>>
        <<% endif %>>
    <<% endfor %>>
<<% endblock %>>
